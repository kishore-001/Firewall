<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Firewall Dashboard</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='dashboard.css') }}"
    />
</head>
<body>
    <div class="container">
        <h2>Welcome, {{ username }}!</h2>
        <div class="logout-box">
            <a href="/logout" class="btn logout-btn">Sign Out</a>
        </div>
        <div class="filter-box">
            <h3>Filter and Block/Unblock</h3>
            <form action="/filter" method="POST">
                <div class="input-group">
                    <label for="ip">IP Address</label>
                    <input type="text" id="ip" name="ip" placeholder="Enter IP" />
                </div>
                <div class="input-group">
                    <label for="mac">MAC Address</label>
                    <input type="text" id="mac" name="mac" placeholder="Enter MAC" />
                </div>
                <div class="input-group">
                    <label for="port">Port</label>
                    <input
                      type="number"
                      id="port"
                      name="port"
                      placeholder="Enter Port"
                    />
                </div>
                <div class="input-group">
                    <label for="protocol">Protocol</label>
                    <select id="protocol" name="protocol">
                        <option value="">Select Protocol</option>
                        <option value="tcp">TCP</option>
                        <option value="udp">UDP</option>
                    </select>
                </div>
                <div class="action-buttons">
                    <button
                      type="submit"
                      name="action"
                      value="block"
                      class="btn block-btn"
                    >
                      Block
                    </button>
                    <button
                      type="submit"
                      name="action"
                      value="unblock"
                      class="btn unblock-btn"
                    >
                      Unblock
                    </button>
                </div>
            </form>
        </div>

        <!-- Display Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %} 
        {% if messages %}
        <div class="messages">
            {% for category, message in messages %}
            <div class="{{ category }}">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %} 
        {% endwith %}

        <!-- New Buttons for Reset and Log Page -->
        <div class="bottom-buttons">
            <a href="/reset" class="btn reset-btn">Reset</a>
            <a href="/logs" class="btn logs-btn">View Logs</a>
        </div>
    </div>
</body>
</html>
